```
一、行情函数
HIGH 最高价
返回该周期最高价。
用法:  HIGH
H 最高价
返回该周期最高价。
用法:  H

LOW 最低价
返回该周期最低价。
用法:  LOW
L 最低价
返回该周期最低价。
用法:  L

CLOSE 收盘价
返回该周期收盘价。
用法:  CLOSE
C 收盘价
返回该周期收盘价。
用法:  C

VOL 成交量
返回该周期成交量。
用法:  VOL
V 成交量
返回该周期成交量。
用法:  V

OPEN 开盘价
返回该周期开盘价。
用法:  OPEN
O:  开盘价
返回该周期开盘价。
用法:  O

ADVANCE 上涨家数
返回该周期上涨家数。
用法:  ADVANCE　(本函数仅对大盘有效)

DECLINE 下跌家数
返回该周期下跌家数。
用法:  DECLINE　(本函数仅对大盘有效)

AMOUNT 成交额
返回该周期成交额。
用法:  AMOUNT

ASKPRICE 委卖价
返回委卖1--委卖3价格。
用法:  ASKPRICE(N)　N取1—3。
(本函数仅个股在分笔成交分析周期有效)

ASKVOL 委卖量
返回委卖1--委卖3量。
用法:  ASKVOL(N)　N取1—3。
(本函数仅个股在分笔成交分析周期有效)

BIDPRICE 委买价
返回委买1--委买3价格。
用法:  BIDPRICE(N)　N取1—3。
(本函数仅个股在分笔成交分析周期有效)

BIDVOL 委买量
返回委买1--委买3量。
用法:  BIDVOL(N)　N取1—3。
(本函数仅个股在分笔成交分析周期有效)

BUYVOL 主动性买盘
返回主动性买单量。
用法: 　BUYVOL　当本笔成交为主动性买盘时，其数值等于成交量，否则为0。
(本函数仅个股在分笔成交分析周期有效)

SELLVOL 主动性卖盘
返回主动性卖单量。
用法: 　SELLVOL　当本笔成交为主动性卖盘时，其数值等于成交量，否则为0。
(本函数仅个股在分笔成交分析周期有效)

ISBUYORDER 主动性买单
返回该成交是否为主动性买单。
用法:  ISBUYORDER　当本笔成交为主动性买盘时，返回1，否则为0。
(本函数仅个股在分笔成交分析周期有效)

ISSELLORDER 主动性卖单
返回该成交是否为主动性卖单。
用法: ISSELLORDER　当本笔成交为主动性卖盘时，返回1，否则为0。
(本函数仅个股在分笔成交分析周期有效)


二　、时间函数
DATE 日期
取得该周期从1900以来的年月日。
用法:  DATE　例如函数返回1000101，表示2000年1月1日。

TIME 时间
取得该周期的时分秒。
用法:  TIME　函数返回有效值范围为(000000-235959)。

YEAR 年份
取得该周期的年份。
用法: YEAR

MONTH 月份
取得该周期的月份。
用法: MONTH　函数返回有效值范围为(1-12)。

WEEK 星期
取得该周期的星期数。
用法:  WEEK　函数返回有效值范围为(0-6)，0表示星期天。

DAY 日期
取得该周期的日期。
用法:  DAY　函数返回有效值范围为(1-31)。

HOUR 小时
取得该周期的小时数。
用法: HOUR　函数返回有效值范围为(0-23)，对于日线及更长的分析周期值为0。

MINUTE 分钟
取得该周期的分钟数。
用法: MINUTE　函数返回有效值范围为(0-59)，对于日线及更长的分析周期值为0。

FROMOPEN 分钟
求当前时刻距开盘有多长时间。
用法: 　FROMOPEN　返回当前时刻距开盘有多长时间，单位为分钟。
例如:　 FROMOPEN　当前时刻为早上十点，则返回31。

三、引用函数
DRAWNULL 无效数
返回无效数。
用法:  DRAWNULL
例如: 　IF(CLOSE>REF(CLOSE，1)，CLOSE，DRAWNULL)　表示下跌时分析图上不画线。

BACKSET 向前赋值
将当前位置到若干周期前的数据设为1。
用法: 　BACKSET(X，N)　若X非0，则将当前位置到N周期前的数值设为1。
例如: 　BACKSET(CLOSE>OPEN，2)　若收阳则将该周期及前一周期数值设为1，否则为0。

BARSCOUNT 有效数据周期数
求总的周期数。
用法: 　BARSCOUNT(X)　第一个有效数据到当前的天数。
例如: 　BARSCOUNT(CLOSE)　对于日线数据取得上市以来总交易日数，对于分笔成交取得当日成交笔数，对于1分钟线取得当日交易分钟数。

BARSLAST 上一次条件成立位置
上一次条件成立到当前的周期数。
用法: 　BARSLAST(X)　上一次X不为0到现在的天数。
例如: 　BARSLAST(CLOSE/REF(CLOSE,1)>=1.1)　表示上一个涨停板到当前的周期数。

BARSSINCE 第一个条件成立位置
第一个条件成立到当前的周期数。
用法: 　BARSSINCE(X)　第一次X不为0到现在的天数。
例如: 　BARSSINCE(HIGH>10)　表示股价超过10元时到当前的周期数。

COUNT 统计
统计满足条件的周期数。
用法: 　COUNT(X，N)　统计N周期中满足X条件的周期数，若N=0则从第一个有效值开始。
例如: 　COUNT(CLOSE>OPEN，20)　表示统计20周期内收阳的周期数。

DMA 动态移动平均
求动态移动平均。
用法: 　DMA(X，A)　求X的动态移动平均。
算法: 　若Y=DMA(X，A)则Y=A*X+(1-A)*Y'，其中Y'表示上一周期Y值，A必须小于1。
例如: 　DMA(CLOSE，VOL/CAPITAL)　表示求以换手率作平滑因子的平均价。

HHV 最高值
求最高值。
用法: 　HHV(X，N)　求N周期内X最高值，N=0则从第一个有效值开始。
例如: 　HHV(HIGH,30)　表示求30日最高价。

HHVBARS 上一高点位置
求上一高点到当前的周期数。
用法: 　HHVBARS(X，N)　求N周期内X最高值到当前周期数，N=0表示从第一个有效值开始统计。
例如: 　HHVBARS(HIGH，0)　求得历史新高到到当前的周期数。

LLV 最低值
求最低值。
用法: 　LLV(X，N)　求N周期内X最低值，N=0则从第一个有效值开始。
例如: 　LLV(LOW，0)　表示求历史最低价。

LLVBARS 上一低点位置
求上一低点到当前的周期数。
用法: 　LLVBARS(X，N)　求N周期内X最低值到当前周期数，N=0表示从第一个有效值开始统计。
例如: 　LLVBARS(HIGH，20)　求得20日最低点到当前的周期数。

REVERSE 求相反数
求相反数。
用法: 　REVERSE(X)　返回-X。
例如: 　REVERSE(CLOSE)　返回-CLOSE。

REF 向前引用
引用若干周期前的数据。
用法: 　REF(X，A)　引用A周期前的X值。
例如: 　REF(CLOSE，1)　表示上一周期的收盘价，在日线上就是昨收。

REFDATE 指定引用
引用指定日期的数据。
用法: 　REFDATE(X，A)　引用A日期的X值。
例如: 　REF(CLOSE，20011208)　表示2001年12月08日的收盘价。

SUM 总和
求总和。
用法: 　SUM(X，N)　统计N周期中X的总和，N=0则从第一个有效值开始。
例如: 　SUM(VOL，0)　表示统计从上市第一天以来的成交量总和。

FILTER 过滤
过滤连续出现的信号。
用法: 　FILTER(X，N)　X满足条件后，删除其后N周期内的数据置为0。
例如: 　FILTER(CLOSE>OPEN，5)　查找阳线，5天内再次出现的阳线不被记录在内。

SUMBARS 累加到指定值的周期数
向前累加到指定值到现在的周期数。
用法: 　SUMBARS(X，A)　将X向前累加直到大于等于A，返回这个区间的周期数。
例如: 　SUMBARS(VOL，CAPITAL)　求完全换手到现在的周期数。

SMA 累积平均
返回累积平均。
用法: 　SMA(X，N，M)　X的M日累积平均，M为权重，如Y=(X*M+Y'*(N-M))/N

MA 简单移动平均
返回简单移动平均。
用法: 　MA(X，M)　X的M日简单移动平均。

EMA 异同移动平均
返回异同移动平均。
用法: 　EMA(X，M)　X的M日异同移动平均。

MEMA 平滑移动平均
返回平滑移动平均
用法: 　MEMA(X，M)　X的M日平滑移动平均。

EXPMA 加权移动平均
返回加权移动平均。
用法: 　EXPMA(X，M)　X的M日加权移动平均。

EXPMEMA 加权平滑平均
返回加权平滑平均。
用法: 　EXPMEMA(X，M)　X的M日加权平滑平均。

RANGE 介于某个范围之间
用法: 　RANGE(A,B,C)　A在B和C。
例如: 　RANGE(A，B，C)表示A大于B同时小于C时返回1，否则返回0。

CONST 取值设为常数
用法: 　CONST(A)　取A最后的值为常量.
例如: 　CONST(INDEXC)表示取大盘现价。

四、逻辑函数
CROSS 上穿
两条线交叉。
用法: 　CROSS(A，B)　表示当A从下方向上穿过B时返回1，否则返回0。
例如: 　CROSS(MA(CLOSE，5)，MA(CLOSE，10))　表示5日均线与10日均线交金叉。

LONGCROSS 维持一定周期后上穿
两条线维持一定周期后交叉。
用法: 　LONGCROSS(A，B，N)　表示A在N周期内都小于B，本周期从下方向上穿过B时返回1，否则返回0。

UPNDAY 连涨
返回是否连涨周期数。
用法: 　UPNDAY(CLOSE,M)　表示连涨M个周期。

DOWNNDAY 连跌
返回是否连跌周期。
用法: 　DOWNNDAY(CLOSE，M)　表示连跌M个周期。

NDAY 连大
返回是否持续存在X>Y。
用法: 　NDAY(CLOSE，OPEN，3)　表示连续3日收阳线。

EXIST 存在
是否存在。
用法: 　EXIST(CLOSE>OPEN，10)　表示前10日内存在着阳线。

EVERY 一直存在
一直存在。
用法: 　EVERY(CLOSE>OPEN，10)　表示前10日内一直阳线。

LAST 持续存在
用法: 　LAST(X,A,B)A>B，表示从前A日到前B日一直满足X条件。若A为0，表示从第一天开始，B为0，表示到最后日止。
例如: 　LAST(CLOSE>OPEN，10，5)　表示从前10日到前5日内一直阳线。

五、算术函数
NOT 取反
求逻辑非。
用法: 　NOT(X)　返回非X，即当X=0时返回1，否则返回0。
例如: 　NOT(ISUP)　表示平盘或收阴。

IF 逻辑判断
根据条件求不同的值。
用法: 　IF(X，A，B)　若X不为0则返回A，否则返回B。
例如: 　IF(CLOSE>OPEN，HIGH，LOW)表示该周期收阳则返回最高值，否则返回最低值。

IFF 逻辑判断
根据条件求不同的值。
用法: 　IFF(X，A，B)　若X不为0则返回A，否则返回B。
例如: 　IFF(CLOSE>OPEN，HIGH，LOW)　表示该周期收阳则返回最高值，否则返回最低值。

IFN 逻辑判断
根据条件求不同的值。
用法: 　IFN(X，A，B)　若X不为0则返回B，否则返回A。
例如: 　IFN(CLOSE>OPEN，HIGH，LOW)　表示该周期收阴则返回最高值，否则返回最低值。

MAX 较大值
求最大值。
用法: 　MAX(A,B)　返回A和B中的较大值。
例如: 　MAX(CLOSE-OPEN，0)　表示若收盘价大于开盘价返回它们的差值，否则返回0。

MIN 较小值
求最小值。
用法: 　MIN(A，B)　返回A和B中的较小值。
例如: 　MIN(CLOSE，OPEN)　返回开盘价和收盘价中的较小值。

六、数学函数
ACOS 反余弦
反余弦值。
用法: 　ACOS(X)　返回X的反余弦值。

ASIN 反正弦
反正弦值。
用法: 　ASIN(X)　返回X的反正弦值。

ATAN 反正切
反正切值。
用法: 　ATAN(X)　返回X的反正切值。

COS 余弦
余弦值。
用法: 　COS(X)　返回X的余弦值。

SIN 正弦
正弦值。
用法: 　SIN(X)　返回X的正弦值。

TAN 正切
正切值。
用法: 　TAN(X)　返回X的正切值。

EXP 指数
指数。
用法: 　EXP(X)　e的X次幂。
例如: 　EXP(CLOSE)　返回e的CLOSE次幂。

LN 自然对数
求自然对数。
用法: 　LN(X)　以e为底的对数。
例如: 　LN(CLOSE)　求收盘价的对数。

LOG 对数
求10为底的对数。
用法: 　LOG(X)　取得X的对数。
例如: 　LOG(100)　等于2。

SQRT 开方
开平方。
用法: 　SQRT(X)　 求X的平方根。
例如: 　SQRT(CLOSE)　收盘价的平方根。

ABS 绝对值
求绝对值。
用法: 　ABS(X)　返回X的绝对值。
例如: 　ABS(-34)　返回34。

POW 乘幂
乘幂。
用法: 　POW(A，B)　返回A的B次幂。
例如: 　POW(CLOSE，3)　求得收盘价的3次方。

CEILING 向上舍入
向上舍入。
用法: 　CEILING(A)　返回沿A数值增大方向最接近的整数。
例如: 　CEILING(12.3)　求得13，CEILING(-3.5)求得-3。

FLOOR 向下舍入
向下舍入。
用法: 　FLOOR(A)　返回沿A数值减小方向最接近的整数。
例如: 　FLOOR(12.3)　求得12，FLOOR(-3.5)求得-4。

INTPART 取整
用法: 　INTPART(A)　返回沿A绝对值减小方向最接近的整数。
例如: 　INTPART(12.3)　求得12，INTPART(-3.5)求得-3。

BETWEEN:  介于
介于。
用法: 　BETWEEN(A，B，C)　表示A处于B和C之间时返回1，否则返回0。
例如: 　BETWEEN(CLOSE，MA(CLOSE，10)，MA(CLOSE，5))表示收盘价介于5日均线和10日均线之间。

七、统计函数
AVEDEV 平均绝对方差
AVEDEV(X，N) 　返回平均绝对方差。

DEVSQ 数据偏差平方和
DEVSQ(X，N) 　返回数据偏差平方和。

FORCAST 线性回归预测值
FORCAST(X，N)　 返回线性回归预测值。

SLOPE 线性回归斜率
SLOPE(X，N)　 返回线性回归斜率。

STD 估算标准差
STD(X，N)　 返回估算标准差。

STDP 总体标准差
STDP(X，N)　 返回总体标准差。

VAR 估算样本方差
VAR(X，N)　 返回估算样本方差。

VARP 总体样本方差
VARP(X，N)　 返回总体样本方差 。


八、横向统计
BLOCKSETNUM 板块股票个数
用法: 　BLOCKSETNUM(板块名称)　返回该板块股票个数。

HORCALC 多股统计
用法: 　HORCALC(板块名称，数据项，计算方式，权重)
数据项: 100-HIGH，101-OPEN，102-LOW，103-CLOSE，104-VOL，105-涨幅
计算方式: 　0-累加，1-排名次
权重: 　0-总股本，1-流通股本，2-等同权重，3-流通市值

九、形态函数
COST 成本分布
成本分布情况。
用法: 　COST(10)，表示10%获利盘的价格是多少，即有10%的持仓量在该价格以下，其余90%在该价格以上，为套牢盘。
该函数仅对日线分析周期有效。

PEAK 波峰值
前M个ZIG转向波峰值。
用法: 　PEAK(K，N，M)　表示之字转向ZIG(K，N)的前M个波峰的数值，M必须大于等于1。
例如: 　PEAK(1,5,1)　表示%5最高价ZIG转向的上一个波峰的数值。

PEAKBARS 波峰位置
前M个ZIG转向波峰到当前距离。
用法: 　PEAKBARS(K，N，M)　表示之字转向ZIG(K，N)的前M个波峰到当前的周期数，M必须大于等于1。
例如: 　PEAKBARS(0，5，1)　表示%5开盘价ZIG转向的上一个波峰到当前的周期数。

SAR 抛物转向
抛物转向。
用法: 　 SAR(N，S，M)，N为计算周期，S为步长，M为极值。
例如: 　SAR(10，2，20)　表示计算10日抛物转向，步长为2%，极限值为20%。

SARTURN 抛物转向点
抛物转向点。
用法: 　SARTURN(N，S，M)　N为计算周期，S为步长，M为极值，若发生向上转向则返回1，若发生向下转向则返回-1，否则为0。
其用法与SAR函数相同。

TROUGH 波谷值
前M个ZIG转向波谷值。
用法: 　TROUGH(K，N，M)　表示之字转向ZIG(K，N)的前M个波谷的数值，M必须大于等于1。
例如: 　TROUGH(2，5，2)　表示%5最低价ZIG转向的前2个波谷的数值。

TROUGHBARS 波谷位置
前M个ZIG转向波谷到当前距离。
用法: 　TROUGHBARS(K，N，M)　表示之字转向ZIG(K，N)的前M个波谷到当前的周期数，M必须大于等于1。
例如: 　TROUGH(2，5，2)　表示%5最低价ZIG转向的前2个波谷到当前的周期数。

WINNER 获利盘比例
获利盘比例。
用法: 　WINNER(CLOSE)　表示以当前收市价卖出的获利盘比例。
例如: 　返回0.1表示10%获利盘，WINNER(10.5)表示10.5元价格的获利盘比例。
该函数仅对日线分析周期有效。

LWINNER 近期获利盘比例
近期获利盘比例。
用法: 　LWINNER(5，CLOSE)　表示最近5天的那部分成本以当前收市价卖出的获利盘比例。例如返回0.1表示10%获利盘。

PWINNER 远期获利盘比例
远期获利盘比例。
用法: 　PWINNER(5，CLOSE)　表示5天前的那部分成本以当前收市价卖出的获利盘比例。例如返回0.1表示10%获利盘。

COSTEX 区间成本
区间成本。
用法: 　COSTEX(CLOSE，REF(CLOSE))，表示近两日收盘价格间筹码的成本，例如返回10表示区间成本为20元。
该函数仅对日线分析周期有效。

PPART 远期成本分布比例
远期成本分布比例。
用法: 　PPART(10)，表示10前的成本占总成本的比例，0.2表示20%。

ZIG 之字转向
之字转向。
用法: 　ZIG(K，N)　当价格变化量超过N%时转向，K表示0:开盘价，1:最高价，2:最低价，3:收盘价，其余:数组信息
例如: 　ZIG(3，5)　表示收盘价的5%的ZIG转向。

十、大盘函数
INDEXA 　 返回大盘成交额
INDEXADV 　 返回上涨家数
INDEXDEC 　 返回下跌家数
INDEXC 　 返回大盘收盘价
INDEXH 　 返回大盘最高价
INDEXL 　 返回大盘最低价
INDEXO 　 返回大盘开盘价
INDEXV 　 返回大盘成交量

十一、绘图函数
PLOYLINE 折线段
在图形上绘制折线段。
用法: 　PLOYLINE(COND，PRICE)，当COND条件满足时，以PRICE位置为顶点画折线连接。
例如: 　PLOYLINE(HIGH>=HHV(HIGH，20)，HIGH)表示在创20天新高点之间画折线。

DRAWLINE 绘制直线段
在图形上绘制直线段。
用法: 　DRAWLINE(COND1，PRICE1，COND2，PRICE2，EXPAND)
当COND1条件满足时，在PRICE1位置画直线起点，当COND2条件满足时，在PRICE2位置画直线终点，EXPAND为延长类型。
例如: 　DRAWLINE(HIGH>=HHV(HIGH，20)，HIGH，LOW<=LLV(LOW，20)，LOW，1)　表示在创20天新高与创20天新低之间画直线并且向右延长。

DRAWKLINE 绘制K线
用法: 　DRAWKLINE(HIGH，OPEN，LOW，CLOSE)　以HIGH为最高价，OPEN为开盘价，LOW为最低，CLOSE收盘画K线。

STICKLINE 绘制柱线
在图形上绘制柱线。
用法: 　STICKLINE(COND，PRICE1，PRICE2，WIDTH，EMPTY)，当COND条件满足时，在PRICE1和PRICE2位置之间画柱状线，宽度为WIDTH(10为标准间距)，EMPTH不为0则画空心柱。
例如: 　STICKLINE(CLOSE>OPEN，CLOSE，OPEN，0.8，1)表示画K线中阳线的空心柱体部分。

DRAWICON 绘制图标
在图形上绘制小图标。
用法: 　DRAWICON(COND，PRICE，TYPE)，当COND条件满足时，在PRICE位置画TYPE号图标。
例如: 　DRAWICON(CLOSE>OPEN，LOW，1)　表示当收阳时在最低价位置画1号图标。图标一共有九个，图形如附图。序号，最下面的是“1”号，最上面的是“9”号。

DRAWTEXT 显示文字
在图形上显示文字。
用法: 　DRAWTEXT(COND，PRICE，TEXT)，当COND条件满足时，在PRICE位置书写文字TEXT。
例如: 　DRAWTEXT(CLOSE/OPEN>1.08，LOW，'大阳线')表示当日涨幅大于8%时在最低价位置显示'大阳线'字样。

十二、财务函数
FINANCE(1)　　　总股本(万股)
FINANCE(2)　　　`！、，D`！BB、股(万股)
FINANCE(3)　　　发起人法人股(万股)
FINANCE(4)　　　法人股(万股)
FINANCE(5)　　　B股(万股)
FINANCE(6)　　　H股(万股)
FINANCE(7)　　　流通股本(万股)
CAPITAL　　 　　流通股本(手)
FINANCE(8) 职工股(万股)
FINANCE(10) 总资产
FINANCE(11) 流动资产
FINANCE(12) 固定资产
FINANCE(13) 无形资产
FINANCE(14) 长期投资
FINANCE(15) 流动负债
FINANCE(16) 　　长期负债
FINANCE(17) 　　资本公积金
FINANCE(18) 每股公积金
FINANCE(19) 　　股东权益
FINANCE(20) 　　主营收入
FINANCE(21) 　　主营利益
FINANCE(22) 　　其它利益
FINANCE(23) 　　营业利益
FINANCE(24) 　　投资收益
FINANCE(25) 　　补贴收入
FINANCE(26) 　　营业外收支
FINANCE(27) 　　上年损益调整
FINANCE(28)　　 利益总额
FINANCE(29) 　　税后利益
FINANCE(30) 　　净利益
FINANCE(31) 　　未分配利益
FINANCE(32) 每股未分配利润
FINANCE(33) 每股收益
FINANCE(34) 　 每股净资产
FINANCE(35)　　 调整每股净资产
FINANCE(36) 　 股东权益比
FINANCE(40) 流通市值
FINANCE(41) 总市值
FINANCE(42) 上市日期

十三、动态行情函数
DYNAINFO(3) 前收盘价
DYNAINFO(4) 今开
DYNAINFO(5) 最高
DYNAINFO(6) 最低
DYNAINFO(7) 现价
DYNAINFO(8) 总手
DYNAINFO(9) 现手
DYNAINFO(10) 总成交金额
DYNAINFO(11) 均价
DYNAINFO(12) 日升跌
DYNAINFO(13) 振幅度
DYNAINFO(14) 涨幅度
DYNAINFO(15) 委托比
DYNAINFO(16) 委量差
DYNAINFO(17) 量比
DYNAINFO(20) 最新叫买价
DYNAINFO(21) 最新叫卖价
DYNAINFO(22) 内盘
DYNAINFO(23) 外盘
DYNAINFO(25) 买一量
DYNAINFO(26) 买二量
DYNAINFO(27) 买三量
DYNAINFO(28) 买一价
DYNAINFO(29) 买二价
DYNAINFO(30) 买三价
DYNAINFO(31) 卖一量
DYNAINFO(32) 卖二量
DYNAINFO(33) 卖三量
DYNAINFO(34) 卖一价
DYNAINFO(35) 卖二价
DYNAINFO(36) 卖三价
DYNAINFO(37) 换手率
DYNAINFO(39) 市盈率
DYNAINFO(40) 成交方向
DYNAINFO(50) 采样点数
DYNAINFO(51) 内外比
DYNAINFO(52) 多空平衡
DYNAINFO(53) 多头获利
DYNAINFO(54) 空头回补
DYNAINFO(55) 多头止损
DYNAINFO(56) 空头止损
DYNAINFO(57) 笔升跌

十四、线形和颜色属性
COLOR 自定义色
格式为COLOR+“RRGGBB”: RR、GG、BB表示红蓝色、绿色和蓝色的分量，每种颜色的取值范围是00-FF，采用了16进制。
例如: MA5: MA(CLOSE，5)，COLOR00FFFF　表示纯红色与纯绿色的混合色: COLOR808000表示淡蓝色和淡绿色的混合色。

COLORBLACK 画黑色
COLORBLUE 画蓝色
COLORGREEN 画绿色
COLORCYAN 画青色
COLORRED 画红色
COLORMAGENTA 画洋红色
COLORBROWN 画棕色
COLORLIGRAY 画淡灰色
COLORGRAY　　　 画深灰色
COLORLIBLUE 画淡蓝色
COLORLIGREEN 画淡绿色
COLORLICYAN 画淡青色
COLORLIRED 画淡红色
COLORLIMAGENTA 画淡洋红色
COLORYELLOW 画黄色
COLORWHITE 画白色
LINETHICK 线型粗细
格式: “LINETHICK+(1-9)”　参数的取值范围在1—9之间，“LINETHICK1”表示最细的线，而“LINETHICK9”表示最粗的线。

STICK 画柱状线
COLORSTICK 画彩色柱状线
VOLSTICK 画彩色柱状线
成交量柱状线，当股价上涨时显示红色空心柱，则显示绿色实心柱

LINESTICK 同时画出柱状线和指标线
CROSSDOT 画小叉线
CIRCLEDOT 画小圆圈线
POINTDOT 画小圆点线
附一: 符号一览表

符号 名称 举例 符号 名称 举例
+ 加 X + Y && 并且 X>Y && Y>Z
- 减 X - Y || 或者 X>Y || Y>Z
* 乘 X * Y $ 修饰符号 "000014$CLOSE"
/ 除 X / Y ( 括号 HIGH/(CLOSE+OPEN)
< 小于 X < Y ) 反括号 HIGH/(CLOSE+OPEN)
> 大于 X > Y , 逗号 MA(Close,3)
<= 小于等于 X <= Y : 输出 输出:CLOSE+OPEN
>= 大于等于 X >= Y := 赋值 变量1:=HIGH
= 等于 X = Y " 双引号 "000014$OPEN"
{} 注释符号 {注释部分} . 点号 KDJ.K
AND 并且 X>Y AND Y>Z ; 分号 A:=CLOSE;
OR 或者 X>Y OR Y>Z # 变周期符号 TMP1:=CLOSE#WEEK
<> 非 X <> Y ' 单引号 '大阳线'


附二: 引用表达式

引用指标指标 "指标名称.指标线名称(参数表)"
引用交易系统指标 "SYSTEM.指标名称.交易类型(参数表)"
引用条件选股指标 "EXPLORER.指标名称(参数表)"
跨周期引用指标 "各种类型指标名称#周期类型(参数表)"
引用任意股票的数据 "股票代码$数据名称"
引用扩展数据 EXTDATA(N) 分析家N=1-11 飞狐N=1-13
引用横向统计日线数据(1-N) ESTDATA(N)
引用类函数第二个变量参数 类函数名称(第一参数,变量名或变量表达式)

000000 cccccc 000000 003300 006600 009900 00CC00 00FF00 000033 003333 006633 009933 00CC33 00FF33 000066 003366 006666 009966 00CC66 00FF66
111111 DDDDDD 330000 333300 336600 339900 33CC00 33FF00 330033 333333 336633 339933 33CC33 33FF33 330066 333366 336666 339966 33CC66 33FF66
222222 EEEEEE 660000 663300 666600 669900 66CC00 66FF00 660033 663333 666633 669933 66CC33 66FF33 660066 663366 666666 669966 66CC66 66FF66
333333 FFFFFF 990000 993300 996600 999900 99CC00 99FF00 990033 993333 996633 999933 99CC33 99FF33 990066 993366 996666 999966 99CC66 99FF66
444444 CC0000 CC3300 CC6600 CC9900 CCCC00 CCFF00 CC0033 CC3333 CC6633 CC9933 CCCC33 CCFF33 CC0066 CC3366 CC6666 CC9966 CCCC66 CCFF66
555555 0000FF FF0000 FF3300 FF6600 FF9900 FFCC00 FFFF00 FF0033 FF3333 FF6633 FF9933 FFCC33 FFFF33 FF0066 FF3366 FF6666 FF9966 FFCC66 FFFF66
666666 00FF00 000099 003399 006699 009999 00CC99 00FF99 0000CC 0033CC 0066CC 0099CC 00CCCC 00FFCC 0000FF 0033FF 0066FF 0099FF 00CCFF 00FFFF
777777 FF0000 330099 333399 336699 339999 33CC99 33FF99 3300CC 3333CC 3366CC 3399CC 33CCCC 33FFCC 3300FF 3333FF 3366FF 3399FF 33CCFF 33FFFF
888888 00FFFF 660099 663399 666699 669999 66CC99 66FF99 6600CC 6633CC 6666CC 6699CC 66CCCC 66FFCC 6600FF 6633FF 6666FF 6699FF 66CCFF 66FFFF
999999 FFFF00 990099 993399 996699 999999 99CC99 99FF99 9900CC 9933CC 9966CC 9999CC 99CCCC 99FFCC 9900FF 9933FF 9966FF 9999FF 99CCFF 99FFFF
AAAAAA FF00FF CC0099 CC3399 CC6699 CC9999 CCCC99 CCFF99 CC00CC CC33CC CC66CC CC99CC CCCCCC CCFFCC CC00FF CC33FF CC66FF CC99FF CCCCFF CCFFFF
BBBBBB FF0099 FF3399 FF6699 FF9999 FFCC99 FFFF99 FF00CC FF33CC FF66CC FF99CC FFCCCC FFFFCC FF00FF FF33FF FF66FF FF99FF FFCCFF FFFFFF


T0002目录下的文件说明

如果重装到一个新位置，只需将整个T0002拷贝过去就可以了,所有的个性化数据都在此目录下

Advhq.dat 星空图相关个性化数据
Block.cfg 板块设置文件
cbset.dat 筹码分析个性化数据
CoolInfo.Txt 系统备忘录
Line.dat 画线工具数据
MyFavZX.dat 资讯收藏夹数据
newmodem.ini 交易客户端个性化数据
padinfo.dat 定制版面个性化数据
PriCS.dat,PriGS.dat,PriText.dat 指标相关数据
recentsearch.dat 最近资讯搜索数据
Scheme.dat 配色方案
tmptdx.css 临时网页CSS文件
user.ini 全局个性化数据
userfx.dat K线图个性化数据
mark.dat 标识信息的存盘文件


以下文件与设置的预警信息有关: 
Col_warn.dat
Col_warn_self.dat
Col_warn2.dat
ColwarnTj.dat

[blocknew] 板块目录
[cache] 系统数据高速缓存
[zst_cache] 分时图数据高速缓存
[coolinfo] 系统备忘录目录
[Invest] 个人理财数据目录
[PAD] 定制牘面存盘文件
通达信 飞狐 大智慧 分析家 指标函数一览 (指标爱好者必看
说明:  H-飞狐 T-通达信 D-大智慧 F-分析家
绘图函数


这组函数的功能是在主图或副图上设定条件输出图象、图标、直线、文字、数字、指标线、指标柱等，全部可以单独使用。
飞狐的强大功能，在此组函数中有淋漓尽致的发挥。无论在表面(美感)，还是实质(提高工作效率)上，都有良好表现。
毫无例外的是，这组函数中，都带有COND。CONDITION，条件，状态。COND在这里可作为条件理解。
为了能找到合适的COND，用于举例子，先介绍一组概念。

高点: 在2N+1根K线中，中间这根K线的H，要大于等于左右N根K线的H。在N+1根K线中，有等高点出现，取最先出现的。
低点: 在2N+1根K线中，中间这根K线的L，要小于等于左右N根K线的L。在N+1根K线中，有等低点出现，取最先出现的。
峰点: 高点和低点，合称为峰点。

(这个定义，意合于技术分析的老祖宗道氏: “只要平均指数的最高点超过了前期的最高点，它就处于牛市时期；当最低点低于前期的最低点时，它处于熊市时期。”这里我们撇开向上、向下分形和分形峰状点等概念，以免把概念复杂化。)
也为了不让指标一来就过于复杂，我们先取N为2来做指标。简介到后面，可以看到，N是可以作为峰点指标的参数进行调整的。

指标名称: FENG2
指标说明: 供引用
指标内容: 

{峰点参数暂定为2}
A:=REF(H,2);{中间K线的最高价}
B:=A>=REF(H,4) AND A>=REF(H,3) AND A>=REF(H,1) AND A>=H;{中间K线的最高价大于等于两边共四根K线的最高价}
D:=BACKSET(B,3);{将当前位置和之前2个周期的数值设为1}
HD:FILTER(D,2);{找到高点后，过滤掉其后2周期内可能出现的等高点。输出高点}
A2:=REF(L,2);{中间K线的最低价}
B2:=A2<=REF(L,4) AND A2<=REF(L,3) AND A2<=REF(L,1) AND A2<=L;{中间K线的最低价小于等于两边共四根K线的最低价}
D2:=BACKSET(B2,3);{将当前位置和之前2个周期的数值设为1}
LD:FILTER(D2,2);{找到低点后，过滤掉其后2周期内可能出现的等低点。输出低点}

{后面有些例子，就从这个指标中引用信号。}

----------------------------------
H
函数: DRAWBKBMP
描述: 设置背景图
类别: 绘图
说明: 根据条件设置背景图

用法: DRAWBKBMP(COND,BMP);当图形上最后一组COND条件满足时,以MyBMP做背景。
示例: DRAWBKBMP(C>O, 'MyBMP');表示图形上最后一组C>O时背景显示子FmlDLL目录下的MyBMP.bmp图。

----------------------------------
H
函数: DRAWGBK
描述: 渐变背景色
类别: 绘图
说明: 绘制渐变背景色
用法: DRAWGBK(COND,COLOR1, COLOR2,D);当COND条件满足时,以COLOR1到COLOR2渐变色填充子图区域,D=0表示从左到右,D=1表示从上到下。
示例: DRAWGBK(C>O, COLORRGB(255,0,0), COLORRGB(255,255,0),0);表示图形上最后一组C>O时从左到右从红色到黄色渐变填充子图。

----------------------------------
H-F-T-D

函数: DRAWICON
描述: 绘制小图标
类别: 绘图
说明: 在图形上绘制小图标
用法: DRAWICON(COND,PRICE,TYPE),当COND条件满足时,在PRICE位置画TYPE号图标。15种图标编码为1-15(1-3为小脸,4-5为上下箭头,6-7为红绿小旗,8-9为三角形,10-12为信号灯,13-15为O、X、四方形)。TYPE为字符串时可显示用户自制BMP图。
示例: DRAWICON(CLOSE>OPEN,LOW,4)表示当收阳时在最低价位置画4号图标。

DRAWICON(C>O, L, 'MyBMP')表示当收阳时在最低价位置画FmlDLL子目录下的自制图标MyBMP.BMP。

这个说明有点老了，飞狐升级飞快，以致帮助文件跟不上变化了。基本意思如说明一样，其它作些补充。

1、COND条件，一般是指判断的结果，不是0就是1。如用其它数据，大于等于1的，条件满足；小于1，条件就不满足。

2、TYPE图标，现在已经有12种，用下面的指标，在000829上可以全部显示出来。当TYPE取大于等于12的数时，都显示黄球。

当TYPE取0时，显示的是笑脸(这个指标中没有做进去，自己可以试一下)。

B:="FENG2.HD";
D:=BACKSET(ISLASTPERIOD,BARSLAST(B)+1);
A:=D>REF(D,1);
DRAWICON(REF(A,1),1.05*H,1);
DRAWICON(REF(A,2),1.05*H,2);
DRAWICON(REF(A,3),1.05*H,3);
DRAWICON(REF(A,4),1.05*H,4);
DRAWICON(REF(A,5),1.05*H,5);
DRAWICON(REF(A,6),1.05*H,6);
DRAWICON(REF(A,7),1.05*H,7);
DRAWICON(REF(A,8),1.05*H,8);
DRAWICON(REF(A,9),1.05*H,9);
DRAWICON(REF(A,10),1.05*H,10);
DRAWICON(REF(A,11),1.05*H,11);
DRAWICON(REF(A,12),1.05*H,12);
DRAWICON(REF(A,13),1.05*H,13);
DRAWICON(REF(A,14),1.05*H,100);{主图叠加}
当红球和绿球连续显示时，立体感会强一些。
DRAWICON(C>=MA(C,30),MA(C,30),10);
DRAWICON(C

3、PRICE是用于定位图标的位置的。一般用1.01＊H，或者0.99*L等。现在可用ALIGN(0-5)指定对齐位置。

用这个指标来试(主图叠加)

B:="FENG2.HD";
D:=BACKSET(ISLASTPERIOD,BARSLAST(B)+1);
A:=D>REF(D,1);
E:=REF(H,1);

DRAWICON(A,E,10),ALIGN0;
DRAWICON(A,E,11),ALIGN1;
DRAWICON(A,E,12),ALIGN2;
DRAWICON(A,E,3),ALIGN3;
DRAWICON(A,E,4),ALIGN4;
DRAWICON(A,E,5),ALIGN5;

可以初步得出结论: 

ALIGN0: 信号出现在PRICE的正中；
ALIGN1: 信号出现在PRICE下边(十分靠近)；
ALIGN2: 信号出现在PRICE上边(十分靠近)；
ALIGN3: 信号出现在主图的中间；
ALIGN4: 信号出现在主图的最上边；
ALIGN5: 信号出现在主图的最下边；

在高低点上作图标，可以使高低点更明确了。

A:="FENG2.LD";
B:="FENG2.HD";

DRAWICON(A,L,11),ALIGN1;
DRAWICON(B,H,10),ALIGN2;{主图叠加}

4、可以自由调用MyBMP.BMP图到显示位置，大大增强了输出的效果。你只要看到好看的图，可以随时抓拍过来，做成BMP文件，放到FmlDLL子目录下，就可以调用了。

A:="FENG2.LD";
B:="FENG2.HD";

DRAWICON(A,L,'PIG'),ALIGN1;
DRAWICON(B,H,'PIG'),ALIGN2;{主图叠加。如果你没有PIG.BMP文件，则不可显示。}
DRAWICON(1,MA(C,5),'S28');
DRAWICON(1,MA(C,10),'S31');
DRAWICON(1,MA(C,20),'S14');
DRAWICON(1,MA(C,30),'S25');{主图叠加。如果你没有PIG.BMP文件，则不可显示。}

函数: DRAWLINE
描述: 绘制直线
类别: 绘图
说明: 在图形上绘制直线段

用法: DRAWLINE(COND1,PRICE1,COND2,PRICE2,EXPAND),当COND1条件满足时,在PRICE1位置画直线起点，当COND2条件满足时,在PRICE2位置画直线终点，EXPAND为延长类型。
示例: DRAWLINE(HIGH>=HHV(HIGH,10),HIGH,LOW<=LLV(LOW,10),LOW,1)表示在创10天新高与创10天新低之间画直线并且向右延长。

DRAWLINE是唯一一个一句里面用到两个COND的绘图函数。因为它需要两个点来决定一直线。
COND1相当于指定K线位置(横坐标)，PRICE1相当于是指定价位(纵坐标)，这样一个点在平面上的位置就决定了。
DRAWLINE是从第一点画到第二点的，即有起点与终点的顺序关系: 第一点出现的时间，要在第二点之前。否则线是画不出来的。
EXPAND，扩张、发展，这里是延伸的意思吧。一般取0，不延长；取1，延长。实际上是取大于等于1的数就延长，小于1就不延长。
DRAWLINE目前支持POINTDOT、LINETHICK、COLOR、SHIFT这四个描述函数。

举个例子吧。

A:="FENG2.LD";
B:="FENG2.HD";
DRAWICON(A,L,11),ALIGN1;
DRAWICON(B,H,10),ALIGN2;
D:=BACKSET(ISLASTPERIOD,BARSLAST(B)+1);
E:=D>REF(D,1);
F:=BACKSET(E,REF(BARSLAST(B),1)+2);
G:=F>REF(F,1);
DRAWLINE(G,H,E,H,1),pointdot,linethick1,coloryellow;{主图叠加}

这根线有些趋势线的意思了。由于趋势线的主观性颇强，只有多设参数才能满足多数人的要求。
DRAWLINE画出的线，应该比手工画出的线精确一些。(DRAWLINE画线的灵敏度，要比手工画线低，所以说DRAWLINE画出的线精确，就未必对。)
主要用于画斜线，水平线我们一般可以另想办法。因为在图中显示直线，并非DRAWLINE的“专利”。

比如: 

A:="FENG2.LD";
B:="FENG2.HD";
D:=BACKSET(ISLASTPERIOD,BARSLAST(A)+1);
E:=D>REF(D,1);
F:=BACKSET(ISLASTPERIOD,BARSLAST(B)+1);
G:=F>REF(F,1);

前高:REF(H,BARSLAST(G));
前低:REF(L,BARSLAST(E));{主图叠加}

----------------------------------
函数: DRAWNUMBER
描述: 显示数字
类别: 绘图
说明: 在图形上显示数字

用法: DRAWNUMBER(COND,PRICE,NUMBER,PRECISION),当COND条件满足时,在PRICE位置书写数字NUMBER(可以为常数或数组序列),PRECISION为小数显示位数(取值范围0-3)。可ALIGN0-5定义对齐方式。
示例: DRAWNUMBER(CLOSE/OPEN>1.08,HIGH,(CLOSE-REF(C,1))/REF(C,1)*100,2)表示当日涨幅大于8%时在最高价位置显示涨幅(相对开盘价的百分比)。

这个函数的特色是，在NUMBER位置可以放变量。
NUMBER,数字。DRAWNUMBER是DRAWTEXT的“兄弟”，也可以用ALIGN(0-5)来定义水平位置，方法相同。

A:="FENG2.LD";
B:="FENG2.HD";

DRAWICON(A,L,11),ALIGN1;
DRAWICON(B,H,10),ALIGN2;

D1:=BACKSET(ISLASTPERIOD,BARSLAST(B)+1);
E1:=D1>REF(D1,1);{离目前最近的一个高点}
D2:=BACKSET(E1,REF(BARSLAST(B),1)+2);
E2:=D2>REF(D2,1);{倒数第二个高点}

DRAWTEXT(E1,H*1.02,'高点价: '),COLORGREEN,ALIGN2;
DRAWNUMBER(E1,H*1.02,H,2),COLORGREEN,ALIGN1;
DRAWTEXT(E2,H*1.02,'高点价: '),COLORYELLOW,ALIGN2;
DRAWNUMBER(E2,H*1.02,H,2),COLORYELLOW,ALIGN1;{主图叠加}

----------------------------------
函数: DRAWTEXT

描述: 加入文字
类别: 绘图
说明: 在图形上显示文字
用法: DRAWTEXT(COND,PRICE,TEXT),当COND条件满足时,在PRICE位置书写文字TEXT,可用'n'换行,可ALIGN0-5定义对齐方式，分析家、通达信不可换行。
示例: DRAWTEXT(CLOSE/OPEN>1.08,LOW,'大阳线')表示当日涨幅大于8%时在最低价位置显示'大阳线'字样。

DRAWTEXT(CLOSE/OPEN>1.08,LOW,'好呀n大涨啦')；可显示多行文本，用"n"换行。

在某些满足条件的地方直接显示文字或字符，比显示图标要更直观一些。
此函数可以用ALIGN来定位水平位置。而ALIGN用在DRAWICON上定位的是高低的位置。

从下面例子可以看到，ALIGN(0~2)定义水平位置的意义: 

ALIGN0: 居中；
ALIGN1: 偏右；
ALIGN2: 偏左。

也可以用SHIFT函数进行向右水平移位。
所显示的文字或字符，可以用COLOR函数来定义颜色。至于文字的大小，则采用系统默认的大小，在此函数中无法定义。
此函数单独使用有其用途，与DRAWNUMBER配合应用时，效果更不错。后面介绍到DRAWNUMBER时再举例子。

A:="FENG2.LD";
B:="FENG2.HD";

DRAWICON(A,L,11),ALIGN1;
DRAWICON(B,H,10),ALIGN2;

D1:=BACKSET(ISLASTPERIOD,BARSLAST(B)+1);
E1:=D1>REF(D1,1);{离目前最近的一个高点}
D2:=BACKSET(E1,REF(BARSLAST(B),1)+2);
E2:=D2>REF(D2,1);{倒数第二个高点}
D3:=BACKSET(E2,REF(BARSLAST(B),1)+2);
E3:=D3>REF(D3,1);{倒数第三个高点}

DRAWTEXT(E1,H*1.01,'☆TEXT:'),COLORRED,ALIGN0;
DRAWTEXT(E2,H*1.01,'★TEXT:'),COLORGREEN,ALIGN1;
DRAWTEXT(E3,H*1.01,'▓TEXT:'),COLORYELLOW,ALIGN2;{主图叠加}

----------------------------------
函数: DRAWYITEXT

描述: 易学文字
类别: 绘图
说明: 在图形上显示易学文字,可ALIGN0-3定义对齐方式
用法: DRAWYITEXT(COND,PRICE,CODE,TYPE),当COND条件满足时,在PRICE位置书写TYPE类型的CODE的对应文字。TYPE为常数，取0--1，分别表示计算的是干支、64卦，CODE为对应的代码。
示例: DRAWYITEXT(CLOSE/OPEN>1.05,LOW, GANZHI(DATE*100, 2),0)表示当日涨幅大于5%时在最低价位置显示日干支。

DRAWYITEXT(REF(CLOSE,2)>REF(OPEN,2) AND REF(CLOSE,1)>REF(OPEN,1) AND CLOSE>OPEN, LOW, KGUA(1, 1), 1 )表示连二阳时在最低价位置显示K线卦象。

-----------------------------------------------
函数: FILLRGN

描述: 区间彩带
类别: 绘图
说明: 绘制指标区间彩带
用法: FILLRGN(COND,PRICE1,PRICE2),当COND条件满足时,以COLOR填充PRICE1和PRICE2的区间。
示例: FILLRGN(MA1>MA2, MA1,MA2),colorred 表示MA1>MA2时以红色填充MA1和MA2之间的区域。

FILL，充满，填充。RGN可能是REGION，地区，地域。
用这个函数，再加DRAWICON可以调用BMP图象文件的功能，可以作出象风景一样的图。

这里举个简单的例子: 

A:=MA(C,5);
B:=MA(C,10);
FILLRGN(1,H*1.01,H*1.02),COLORFFFF66;
FILLRGN(A>=B,A,B),COLORMAGENTA;
FILLRGN(A
FILLRGN(1,L*0.99,L*0.98),COLORFF99CC;{主图叠加}

----------------------------------
函数: PARTLINE

描述: 分段绘制指标线
类别: 绘图
说明: 分段绘制指标线
用法: PARTLINE(COND,PRICE),满足COND条件绘制PRICE连线。
示例: PARTLINE(C>REF(C,1),C),colorred表示收盘大于前收以红色绘制收盘价连线。

PART，部分，局部。值得一提的是，PARTLINE支持多种描述函数，如例所见。

A:=MA(C,5);
B:=MA(C,10);
PARTLINE(A>=B,A),COLORRED,POINTDOT;
PARTLINE(A>=B,B),COLORGREEN,CIRCLEDOT;
PARTLINE(A
PARTLINE(A

----------------------------------
函数: POLYLINE

描述: 绘制折线段
类别: 绘图
说明: 在图形上绘制折线段
用法: POLYLINE(COND,PRICE),当COND条件满足时,以PRICE位置为顶点画折线连接。
示例: POLYLINE(HIGH>=HHV(HIGH,10),HIGH)表示在创10天新高点之间画折线。

POLY，多个的。

支持POINTDOT、LINETHICK、COLOR、SHIFT这四个描述函数。

A:="FENG2.LD";
B:="FENG2.HD";
DRAWICON(A,L,11),ALIGN1;
DRAWICON(B,H,10),ALIGN2;
POLYLINE(A,L),POINTDOT,COLORGREEN;
POLYLINE(B,H),LINETHICK2,COLORMAGENTA;{主图叠加}

----------------------------------
函数: STICKLINE

描述: 绘制柱线
类别: 绘图
说明: 在图形上绘制柱线

用法: STICKLINE(COND,PRICE1,PRICE2,WIDTH,EMPTY),
当COND条件满足时,在PRICE1和PRICE2位置之间画柱状线，宽度为WIDTH可为0-100(10为标准间距),EMPTH不为0大于等于1则画空心柱。宽度为WIDTH(10为标准间距)。

示例: STICKLINE(CLOSE>OPEN,CLOSE,OPEN,8,1)表示画K线中阳线的空心柱体部分。STICKLINE(CLOSE>OPEN,HIGH,LOW,0.8,1)表示画K线中阳线的高低线部分。

说明三点: 

1、PRICE1和PRICE2没有顺序关系，即何者在前何者在后都不影响语句的执行。
2、WIDTH宽度，支持小数。用1和用0.1，会有很大的差别。取7时和主图的K线宽度差不多。

以下的副图指标，画出的K线，与主图中显示的K线差不多。有些“主图叠加指标”，叠加在副图中也未尝不可了。

STICKLINE(C>O OR (C=O AND C>REF(C,1)),O,C,7,1),colorred;{画出红K实体}
STICKLINE((C>O AND C<>H) OR (C=O AND C>REF(C,1)),C,H,0.1,0),colorred;{画出红K上影线}
STICKLINE((C>O AND L<>O) OR (C=O AND C>REF(C,1)),L,O,0.1,0),colorred;{画出红K下影线}
STICKLINE(C<=REF(C,1)),C,O,7,0),colorcyan;{画出青K实体}
STICKLINE(C<=REF(C,1)),L,H,0.1,0),colorcyan;{画出青K影线。因为青K是实心的，所以影线从中穿过}

MA(C,5);

3、用STICKLINE可以用两种方法做出多色彩K线效果。

一种是横向的，将K线实体从O到C分为N等份，每个小格中放入不同的但比较连续的颜色。
这里随便举个例子，N取4，只对阳线加了效果。其它变化，道理是一样的。

A:=C-O;
B:=C>O;
STICKLINE(B,O,O+A/4,8,0),COLORFF99FF;
STICKLINE(B,O+A/4,O+A*2/4,8,0),COLORFF00FF;
STICKLINE(B,O+A*2/4,O+A*3/4,8,0),COLOR9900FF;
STICKLINE(B,O+A*3/4,O+A,8,0),COLOR0000FF;{主图叠加}

还有一种方法就是纵向的了。先在较宽的K线中加颜色，然后把宽度逐步收窄，再加颜色覆盖以前的，这样从纵向看，一根K线中就有不同颜色了。效果做得好的，可以做到赏心悦目。

B:=C>O;

STICKLINE(B,O,C,8,0),COLORFF99FF;
STICKLINE(B,O,C,6,0),COLORFF00FF;
STICKLINE(B,O,C,4,0),COLOR9900FF;
STICKLINE(B,O,C,2,0),COLOR0000FF;{主图叠加}

----------------------------------
函数: VERTLINE

描述: 绘制垂直线段
类别: 绘图
说明: 在图形上绘制垂直线段
用法: VERTLINE(COND),在COND条件满足的周期处画垂直线。
示例: VERTLINE(HIGH>=HHV(HIGH,20))表示在创20天新高时画垂直线。

VERTICAL，垂直的。

VERTLINE目前可以用POINTDOT、LINETHICK、COLOR、SHIFT这四个描述函数来描述。

这个函数，主要是用于画线看时间的。费波纳契周期，可以用这个函数画出来的。

这里举个例子，把日K线中每月的第一个交易日中，画一根垂直线。

A:=MONTH>REF(MONTH,1);
VERTLINE(A),COLOR808040,POINTDOT;{主图叠加}

 
XMA到底是什么？揭开XMA的面纱！

1，2，3，4，5，6，7，8，9，10，11，12，13，14，15，16，17，18，19，20.。。。。。。。。

如果在10这个地方统计MA(C,5)=(6+7+8+9+10)/5;这是以10为终点,向前统计法;
如果在10这个地方统计XMA(C,5)=(8+9+10+11+12)/5;这是以10为中点,从中间向前和向后统计法;
如果在10这个地方统计MA(C,7)=(4+5+6+7+8+9+10)/7;这是以10为终点,向前统计法;
如果在10这个地方统计XMA(C,7)=(7+8+9+10+11+12+13)/7;这是以10为中点,从中间向前和向后统计法;
如果在10这个地方统计MA(C,9)=(2+3+4+5+6+7+8+9+10)/9;这是以10为终点,向前统计法;
如果在10这个地方统计XMA(C,9)=(6+7+8+9+10+11+12+13+14)/9;这是以10为中点,从中间向前和向后统计法;
假如今天就是10号收盘,前面的数据已经发生了,但是11号、12、13、14、15、16、17、18、19、20......没有发生，没有发生就没数据，但XMA如何给没发生的赋值数据呢？

原理很简单: 
假如是XMA(C,7),以10号收盘来统计XMA(C,7),7、8、9、10数据已经有了，但11、12、13还没发生，数据没有，怎么办？就是这用7、8、9、10这4天的平均价赋值分别给11、12、13；然后全部求平均。
如果是N天呢？N天后的没有发生的怎么赋值？那就用N天前的包括N天的((N+1)/2)天的平均价赋值；

但是有一点，XMA还怪在这里: 当今天10号已经过去，11号变成今天，昨天对11号没发生的赋值又会用今天的实际值来取代。用11号实际发生的数值取代昨天对今天的赋值；
XMA(C,N)里的一般为奇数，当N设定为偶数时候，它怎么办呢？就是自动采用N+1法自动调整为奇数。

XMA均线的看法
MA和XMA的一部分算法一样。比如: 
MA(C,N)=(REF(C,N-1)+--REF(C,N-2)+REF(C,N=1)+C)/N
XMA(C,N)=(REF(C,N-1)+--REF(C,N-2)+REF(C,N=1)+C)/N
这两个函数的这个值算法相同。不同的是这个值放到什么位置上。
MA是把这个值放到计算当天。而XMA把这个值放到向前数第(N+1)/2的位置上。所以从这个角度看，XMA更符合平均值的计算原理，把平均值赋给中间数才是合理的。MA虽然使数值固定不变，但对原理来讲并不合理。
因为XMA把数值赋给中间位置的数，所以就存在一个问题，就是所有在中间数值{(N+1)/2}这个位置以前的数都是固定不变的了，那么就出现一个问题，在中间数值{(N+1)/2}这个位置以后的{(N-1)/2}位的数值怎么给定？这些位置数值的算法是什么样的那？
我们这里举个容易判断的例子。给定N值=5。
那么(5+1)/2=3,3位和其之前的数都固定了，只有本位数和{(N-1)/2}位数没有固定，这两个数值怎么给出那？
当日本位XMA(C,N)的数值=[当日起向前((N+1)/2)位的数值之和]/(N+1)/2。
当日向前M日位置的数值: 
=[当日起向前((N+1)/2+M)位的数值之和]/[(N+1)/2+M]。
一直到((N+1)/2+M)+1=N为止。
期间位数为偶数时等同加一位，例如N=2相当于N=3来处理。
例: 
A B C D E F G H J K L M N O P 
1 2 3 4 5 6 7 8 9 1 
字母代表XMA价格，数字代表实际价格。
如果一个7日XMA均线。XMA(X，N)；
N=7；M=前一数距离A的位置数；
A=(1+2+3+4)/4；B=(1+2+3+4+5)/5；C=(1+2+3+4+5+6)/6；
D=(1+2+3+4+5+6+7)/7；E=(2+3+4+5+6+7+8)/7；
A=[(N+1)/2位数之和]/(N+1)/2位；
B=[(N+1)/2+M位数之和]/(N+1)/2+M位；这里的M=1；

C=[(N+1)/2+M位数之和]/(N+1)/2+M位；这里的M=2；
D=[N位数之和/N位]；此值向后数值全部固定。
E=[A倒退一位后的N位数之和/N位]；此值固定。
这里我们看到A值其实就是4日均线值，等同于MA(C,4),B值等同于从A开始的5日均线值，依次类推。
这样我们只要做出一个XMA(Q,N)中的N日平均线就能得到历史上没有漂移时期的XMA(Q,N)的值了。这样就可以考察各个时期XMA的均线漂移情况了。

XMA(C,N)嵌套循环，其中N值取的小一些，这样，如果循环的次数越多，对以前的数值影响长度就越大，但数值变化幅度减小，对近期的数值变化幅度也减小，这样的好处是使越接近现在的数值变化的范围可以小一些，减少近期失真或过度漂移的现象，不利的地方是使整条均线数值的大部分成为动态值，只不过动态范围很小。

如果XMA(C,N)不使用嵌套循环，N值取的过小，均线不平滑。N值取得大一些，近期N的后半期数值变化(漂移)幅度会比嵌套循环的幅度大一些，也就是说接近近期的数值漂移会比嵌套的严重些，但优点是在N/2之前的数值全部固定不变，不会有任何漂移了。

下面是我为了分析做的图表，从图表中可以看出，(这里我做的是一个3天23层循环套XMA的原理)循环的层数等于向前影响的天数，就是说一个3天23层的XMA循环套的均线值从收盘当日起向前23天都是变化的，而且随着嵌套层的增加，这种向前的影响不断增加，但幅度不断减小。因为层数越多其中参与计算的固定下来的数值越多，第一天没有固定值，第二天有两个固定值，第三天有三个，不断增加。我们假设一下，如果这种嵌套接近无穷，那么可以认为这条均线每天都变化，是整体变化，就是说当天的收盘数值将影响到上市前3天的均线数值，哈哈，这个未来影响满大的，不过幅度会很小很小，因为他平均了上市以来的所有波动，因为时间漫长，摊到每一天上就很小了很小了。

 

 

通达信公式编辑中部分函数(注释)

HIGH――最高价----返回该周期最高价。用法: HIGH
LOW――最低价----返回该周期最低价。用法: LOW
CLOSE――收盘价----返回该周期收盘价。用法: CLOSE
VOL――成交量----返回该周期成交量。用法: VOL
OPEN――开盘价----返回该周期开盘价。用法: OPEN
ADVANCE――上涨家数----返回该周期上涨家数。用法: ADVANCE(本函数仅对大盘有效)
DECLINE――下跌家数----返回该周期下跌家数。用法: DECLINE(本函数仅对大盘有效)
AMOUNT――成交额----返回该周期成交额。用法: AMOUNT
ASKPRICE――委卖价----返回委卖1--委卖3价格。用法: ASKPRICE(N),N取1--3(本函数仅个股在分笔成交分析周期有效)
ASKVOL――委卖量----返回委卖1--委卖3量。用法: ASKVOL(N),N取1--3(本函数仅个股在分笔成交分析周期有效)
BIDPRICE――委买价----返回委买1--委买3价格。用法: BIDPRICE(N),N取1--3(本函数仅个股在分笔成交分析周期有效)
ASKVOL――委卖量----返回委卖1--委卖3量。用法: ASKVOL(N),N取1--3(本函数仅个股在分笔成交分析周期有效)
BUYVOL――主动性买盘----返回主动性买单量。用法: BUYVOL
当本笔成交为主动性买盘时,其数值等于成交量,否则为0(本函数仅个股在分笔成交分析周期有效)

SELLVOL――主动性卖单----返回主动性卖单量。用法: SELLVOL
当本笔成交为主动性卖盘时,其数值等于成交量,否则为0(本函数仅个股在分笔成交分析周期有效)

DATA――日期----取得该周期从1900以来的的年月日。用法: DATE
　　　　　　　　　　例如函数返回1000101,表示2001年1月1日
TIME――时间----取得该周期的时分秒。用法:: TIME
函数返回有效值范围为(000000-235959)
YEAR――年份----取得该周期的年份。用法: YEAR
MONTH――月份----取得该周期的月份。用法: MONTH
　　　　　　　　　　　函数返回有效值范围为(1-12)
WEEKDAY――星期----取得该周期的星期数。用法: WEEK
　　　　　　　　　　　函数返回有效值范围为(0-6)，0表示星期天
DAY――日----取得该周期的日期。用法: DAY
　　　　　　　　　　　函数返回有效值范围为(1-31)
HOUR――小时----取得该周期的小时数。用法: HOUR
函数返回有效值范围为(0-23)，对于日线及更长的分析周期值为0
MINUTE――分钟----取得该周期的分钟数。用法: MINUTE
函数返回有效值范围为(0-59)，对于日线及更长的分析周期值为0
BACKSET――向前赋值----将当前位置到若干周期前的数据设为1。
用法: BACKSET(X,N),若X非0,则将当前位置到N周期前的数值设为1。
例如: BACKSET(CLOSE>OPEN,2)若收阳则将该周期及前一周期数值设为1,否则为0
BARSCOUT――有效数据周期数----求总的周期数。
用法: BARSCOUNT(X)第一个有效数据到当前的天数
例如: BARSCOUNT(CLOSE)对于日线数据取得上市以来总交易日数，对于分笔成交取得当日成交笔数，对于1分钟线取得当日交易分钟数
BARSLAST――上一条件成立位置----上一次条件成立到当前的周期数。
用法: BARSLAST(X):上一次X不为0到现在的天数
例如: BARSLAST(CLOSE/REF(CLOSE,1)>=1.1)表示上一个涨停板到当前的周期数
BARSSINCE――第一个条件成立位置----第一个条件成立到当前的周期数。
用法: BARSSINCE(X):第一次X不为0到现在的天数
例如: BARSSINCE(HIGH>10)表示股价超过10元时到当前的周期数
COUNT――统计----统计满足条件的周期数。
用法: 
COUNT(X,N),统计N周期中满足X条件的周期数,若N=0则从第一个有效值开始。
例如: COUNT(CLOSE>OPEN,20)表示统计20周期内收阳的周期数

DMA――动态移动车前均----求动态移动平均。

用法: DMA(X,A),求X的动态移动平均。
算法: 若Y=DMA(X,A)则 Y=A*X+(1-A)*Y',其中Y'表示上一周期Y值,A必须小于1。
例如: DMA(CLOSE,VOL/CAPITAL)表示求以换手率作平滑因子的平均价

HHV――最高值----求最高值。
用法: HHV(X,N),求N周期内X最高值,N=0则从第一个有效值开始。
例如: HHV(HIGH,30)表示求30日最高价

HHVBARS――上一高点位置----求上一高点到当前的周期数。
用法: 
HHVBARS(X,N):求N周期内X最高值到当前周期数，N=0表示从第一个有效值开始统计
例如: HHVBARS(HIGH,0)求得历史新高到到当前的周期数

LLV――最低值----求最低值。
用法: LLV(X,N),求N周期内X最低值,N=0则从第一个有效值开始。
例如: LLV(LOW,0)表示求历史最低价

LLVBARS――上一低点位置----求上一低点到当前的周期数。
用法: 
LLVBARS(X,N):求N周期内X最低值到当前周期数，N=0表示从第一个有效值开始统计
例如: LLVBARS(HIGH,20)求得20日最低点到当前的周期数

REF――目前的----引用若干周期前的数据。
用法: REF(X,A),引用A周期前的X值。
例如: REF(CLOSE,1)表示上一周期的收盘价，在日线上就是昨收

SUM――累积----求总和。
用法: SUM(X,N),统计N周期中X的总和,N=0则从第一个有效值开始。
例如: SUM(VOL,0)表示统计从上市第一天以来的成交量总和

SUMBARS―― 累加到指定周期数----向前累加到指定值到现在的周期数。
用法: SUMBARS(X,A):将X向前累加直到大于等于A,返回这个区间的周期数
例如: SUMBARS(VOL,CAPITAL)求完全换手到现在的周期数

SMA――累积平均----返回累积平均
用法: SMA(X,N,M):X的M日累积平均,M为权重,如Y=(X*M+Y'*(N-M))/N

MA:――简单移动平均----返回简单移动平均
用法: MA(X,M):X的M日简单移动平均

EMA:――异同移动平均----返回异同移动平均
用法: EMA(X,M):X的M日异同移动平均

MEMA―― 平滑移动平均----返回平滑移动平均
用法: MEMA(X,M):X的M日平滑移动平均

EXPMA――加权移动平均----返回加权移动平均
用法: EXPMA(X,M):X的M日加权移动平均

EXPMEMA――加权平滑平均----返回加权平滑平均
用法: EXPMEMA(X,M):X的M日加权平滑平均

RANGE――幅差---- RANGE(A,B):AB幅差。
用法: RANGE(CLOSE,OPEN)
表示(CLOSE-OPEN)/OPEN

CROSS: 上穿----两条线交叉。
用法: CROSS(A,B)表示当A从下方向上穿过B时返回1，否则返回0
例如: CROSS(MA(CLOSE,5),MA(CLOSE,10))表示5日均线与10日均线交金叉

UPNDAY――连涨----返回是否连涨周期数。
用法: UPNDAY(CLOSE,M)
表示连涨M个周期

DOWNNDAY――连跌----返回是否连跌周期。
用法: DOWNNDAY(CLOSE,M)
表示连跌M个周期

NDAY――连大----返回是否持续存在X>Y
用法: NDAY(CLOSE,OPEN,3)
表示连续3日收阳线

EXIST――存在----是否存在。
用法: EXIST(CLOSE>OPEN,10)
表示前10日内存在着阳线

EVERY――一直存在----一直存在。
用法: EVERY(CLOSE>OPEN,10)
表示前10日内一直阳线

LAST――持续存在---- LAST(X,A,B):持续存在。
用法: LAST(CLOSE>OPEN,10,5) 表示从前10日到前5日内一直阳线
若A为0,表示从第一天开始,B为0,表示到最后日止

NOT――取反----求逻辑非。
用法:NOT(X)返回非X,即当X=0时返回1，否则返回0
例如: NOT(ISUP)表示平盘或收阴

IF――逻辑判断----根据条件求不同的值。
用法: IF(X,A,B)若X不为0则返回A,否则返回B
例如: IF(CLOSE>OPEN,HIGH,LOW)表示该周期收阳则返回最高值，否则返回最低值

IFF―― 逻辑判断---- 根据条件求不同的值。
用法: IFF(X,A,B)若X不为0则返回A,否则返回B
例如: IFF(CLOSE>OPEN,HIGH,LOW)表示该周期收阳则返回最高值，否则返回最低值

IFN―― 逻辑判断----根据条件求不同的值。
用法: IFN(X,A,B)若X不为0则返回B,否则返回A
例如: IFN(CLOSE>OPEN,HIGH,LOW)表示该周期收阴则返回最高值，否则返回最低值

MAX――较大值----求最大值。
用法: MAX(A,B)返回A和B中的较大值
例如: MAX(CLOSE-OPEN,0)表示若收盘价大于开盘价返回它们的差值，否则返回0

MIN――较小值----求最小值。
用法: MIN(A,B)返回A和B中的较小值
例如: MIN(CLOSE,OPEN)返回开盘价和收盘价中的较小值

ACOS―― 反余弦----反余弦值。用法: ACOS(X)返回X的反余弦值
ASIN―― 反正弦----反正弦值。用法: ASIN(X)返回X的反正弦值
ATAN―― 反正切----反正切值。用法: ATAN(X)返回X的反正切值
COS――余弦----余弦值。用法: COS(X)返回X的余弦值
SIN――正弦----正弦值。用法: SIN(X)返回X的正弦值
TAN――正切----正切值。用法: TAN(X)返回X的正切值
EXP――指数----指数。用法: EXP(X)为e的X次幂。例如: EXP(CLOSE)返回e的CLOSE次幂
LN――自然对数----求自然对数。用法: LN(X)以e为底的对数
例如: LN(CLOSE)求收盘价的对数
LOG――对数----求10为底的对数。用法: LOG(X)取得X的对数
　　　　　　　　　　　　　　　　例如: LOG(100)等于2
SORT――开方----开平方。用法: SQRT(X)为X的平方根
例如: SQRT(CLOSE)收盘价的平方根
POW――乘幂----乘幂。用法: POW(A,B)返回A的B次幂
　　　　　　　例如: POW(CLOSE,3)求得收盘价的3次方
ABS――绝对值----求绝对值。用法: ABS(X)返回X的绝对值。
例如: ABS(-34)返回34
AVEDEV―― 平均绝对方差---- AVEDEV(X,N) 返回平均绝对方差
DEVSQ―― 数据偏差平方和---- DEVSQ(X,N) 返回数据偏差平方和
FORCAST――线性回归预测值---- FORCAST(X,N) 返回线性回归预测值
SLOPE―― 线性回归斜率---- SLOPE(X,N) 返回线性回归斜率
STD――估算标准差---- STD(X,N) 返回估算标准差
STDP―― 总体标准差---- STDP(X,N) 返回总体标准差
VAR―― 估算样本方差----- VAR(X,N) 返回估算样本方差
VARP―― 总体样本方差---- VARP(X,N) 返回总体样本方差

COST―― 成本分布----成本分布情况。
用法: 
COST(10),表示10%获利盘的价格是多少，即有10%的持仓量在该价格以下，其余90%在该价格以上，为套牢盘
该函数仅对日线分析周期有效
PEAK―― 波峰值----前M个ZIG转向波峰值。
用法:
PEAK(K,N,M)表示之字转向ZIG(K,N)的前M个波峰的数值,M必须大于等于1
例如: PEAK(1,5,1)表示%5最高价ZIG转向的上一个波峰的数值
PEAKBARS―― 波峰位置----前M个ZIG转向波峰到当前距离。
用法:
PEAKBARS(K,N,M)表示之字转向ZIG(K,N)的前M个波峰到当前的周期数,M必须大于等于1
例如: PEAK(0,5,1)表示%5开盘价ZIG转向的上一个波峰到当前的周期数
SAR―― 抛物转向----抛物转向。
用法: SAR(N,S,M),N为计算周期,S为步长,M为极值
例如SAR(10,2,20)表示计算10日抛物转向，步长为2%，极限值为20%
SARTURN―― 抛物转向点----抛物转向点。
用法:
SARTURN(N,S,M),N为计算周期,S为步长,M为极值,若发生向上转向则返回1，若发生向下转向则返回-1，否则为0
其用法与SAR函数相同
TROUGH―― 波谷值----前M个ZIG转向波谷值。
用法:
TROUGH(K,N,M)表示之字转向ZIG(K,N)的前M个波谷的数值,M必须大于等于1
例如: TROUGH(2,5,2)表示%5最低价ZIG转向的前2个波谷的数值
TROUGHBARS―― 波谷位置----前M个ZIG转向波谷到当前距离。
用法:
TROUGHBARS(K,N,M)表示之字转向ZIG(K,N)的前M个波谷到当前的周期数,M必须大于等于1
例如: TROUGH(2,5,2)表示%5最低价ZIG转向的前2个波谷到当前的周期数
WINNER―― 获利盘比例----获利盘比例。
用法:
WINNER(CLOSE),表示以当前收市价卖出的获利盘比例，例如返回0.1表示10%获利盘；WINNER(10.5)表示10.5元价格的获利盘比例
该函数仅对日线分析周期有效
ZIG―― 之字转向----之字转向。
用法:
ZIG(K,N),当价格变化量超过N%时转向,K表示0:开盘价,1:最高价,2:最低价,3:收盘价
例如: ZIG(3,5)表示收盘价的5%的ZIG转向

INDEXA―― 返回大盘成交额 INDEXADV ―― 返回上涨家数 INDEXDEC ―― 返回下跌家数
INDEXC ―― 返回大盘收盘价 INDEXH ―― 返回大盘最高价 INDEXL ―― 返回大盘最低价
INDEXO ―― 返回大盘开盘价 INDEXV　―― 返回大盘成交量

FINANCE(1) ―― 流通市值
FINANCE(2) ―― 流通股本
FINANCE(3) ―― 总市值
FINANCE(4) ―― 每股未分配利润
FINANCE(5) ―― 每股收益
FINANCE(6) ―― 每股公积金
FINANCE(7) ―― 每股净资产
FINANCE(8) ―― 股东权益比
FINANCE(9) ―― 上市日期
FINANCE(10) ――总股本
FINANCE(11)―― 国家股
FINANCE(12) ――发起人法人股
FINANCE(13) ――法人股
FINANCE(14) ――B股
FINANCE(15) ――H股
FINANCE(16) ――职工股
FINANCE(17) ――流动资产
FINANCE(18) ――固定资产
FINANCE(19) ――无形资产
FINANCE(20) ――长期投资
FINANCE(21) ――流动负债
FINANCE(22) ――长期负债
FINANCE(23) ――资本公积金
FINANCE(24) ――股东权益
FINANCE(25) ――主营收入
FINANCE(26) ――主营利益
FINANCE(27) ――其它利益
FINANCE(28) ――营业利益
FINANCE(29) ――投资收益
FINANCE(30) ――补贴收入
FINANCE(31) ――营业外收支
FINANCE(32) ――上年损益调整
FINANCE(33) ――利益总额
FINANCE(34) ――税后利益
FINANCE(35) ――净利益
FINANCE(36) ――未分配利益
FINANCE(37) ――调整每股净资产
FINANCE(38) ――总资产
DYNAINFO(1)―― 前收盘价
DYNAINFO(2) ―― 今开
DYNAINFO(3) ―― 最高
DYNAINFO(4) ―― 最低
DYNAINFO(6) ―― 现价
DYNAINFO(7) ―― 最新叫买价
DYNAINFO(8) ―― 最新叫卖价
DYNAINFO(9) ―― 总成交金额
DYNAINFO(10) ――内盘
DYNAINFO(11) ――外盘
DYNAINFO(12) ――总手
DYNAINFO(13) ――现手
DYNAINFO(14) ――笔升跌
DYNAINFO(15) ――买一价
DYNAINFO(16) ――买二价
DYNAINFO(17) ――买三价
DYNAINFO(18) ――买一量
DYNAINFO(19) ――买二量
DYNAINFO(20) ――买三量
DYNAINFO(21) ――卖一价
DYNAINFO(22) ――卖二价
DYNAINFO(23) ――卖三价
DYNAINFO(24) ――卖一量
DYNAINFO(25) ――卖二量
DYNAINFO(26) ――卖三量
DYNAINFO(27) ――市盈率
DYNAINFO(28) ――换手率
DYNAINFO(29) ――日升跌
DYNAINFO(30) ――笔升跌
DYNAINFO(31) ――内外比
DYNAINFO(32) ――委量差
DYNAINFO(33) ――委托比
DYNAINFO(34) ――涨幅度
DYNAINFO(35) ――振幅度
DYNAINFO(36) ――均价
DYNAINFO(37) ――量比

横向统计函数

BLOCKSETNUM 板块股票个数
用法: 　BLOCKSETNUM(板块名称)　返回该板块股票个数。

HORCALC 多股统计
用法: 　HORCALC(板块名称，数据项，计算方式，权重)
数据项: 100-HIGH，101-OPEN，102-LOW，103-CLOSE，104-VOL，105-涨幅
计算方式: 　0-累加，1-排名次
权重: 　0-总股本，1-流通股本，2-等同权重，3-流通市值

绘图函数

PLOYLINE 折线段
在图形上绘制折线段。
用法: 　PLOYLINE(COND，PRICE)，当COND条件满足时，以PRICE位置为顶点画折线连接。
例如: 　PLOYLINE(HIGH>=HHV(HIGH，20)，HIGH)表示在创20天新高点之间画折线。

DRAWLINE 绘制直线段
在图形上绘制直线段。
用法: 　DRAWLINE(COND1，PRICE1，COND2，PRICE2，EXPAND)
当COND1条件满足时，在PRICE1位置画直线起点，当COND2条件满足时，在PRICE2位置画直线终点，EXPAND为延长类型。
例如: 　DRAWLINE(HIGH>=HHV(HIGH，20)，HIGH，LOW<=LLV(LOW，20)，LOW，1)　表示在创20天新高与创20天新低之间画直线并且向右延长。

DRAWKLINE 绘制K线
用法: 　DRAWKLINE(HIGH，OPEN，LOW，CLOSE)　以HIGH为最高价，OPEN为开盘价，LOW为最低，CLOSE收盘画K线。

STICKLINE 绘制柱线
在图形上绘制柱线。
用法: 　STICKLINE(COND，PRICE1，PRICE2，WIDTH，EMPTY)，当COND条件满足时，在PRICE1和PRICE2位置之间画柱状线，宽度为WIDTH(10为标准间距)，EMPTH不为0则画空心柱。
例如: 　STICKLINE(CLOSE>OPEN，CLOSE，OPEN，0.8，1)表示画K线中阳线的空心柱体部分。

DRAWICON 绘制图标
在图形上绘制小图标。
用法: 　DRAWICON(COND，PRICE，TYPE)，当COND条件满足时，在PRICE位置画TYPE号图标。
例如: 　DRAWICON(CLOSE>OPEN，LOW，1)　表示当收阳时在最低价位置画1号图标。图标一共有九个，图形如附图。序号，最下面的是“1”号，最上面的是“9”号。

DRAWTEXT 显示文字
在图形上显示文字。
用法: 　DRAWTEXT(COND，PRICE，TEXT)，当COND条件满足时，在PRICE位置书写文字TEXT。
例如: 　DRAWTEXT(CLOSE/OPEN>1.08，LOW，'大阳线')表示当日涨幅大于8%时在最低价位置显示'大阳线'字样。

以上函数均为通达信的,目的熟悉函数,能够编写简单的公式和修改一些公式,能看懂一些公式是如何编的

常用语句，以方便朋友们编写公式时参考使用,初学的可以尝试对照一些简单的公式先试着自己修改以下.看看公式发生了哪些变化.
 

公式指标编辑必备(一)

1)今收盘对于N日内最低收盘价的涨幅(%)(c-llv(c,n))/llv(c,n)*100;
2)今收盘价对于N日最高收盘价的跌幅(%)(HHV(C,N)-C)/HHV(C,N)*100;
3)股价在过去N日内运行空间的相对位置 (C-LLV(L,N))/(HHV(H,N)-LLV(L,N))*100;

4)股价上方N1%至N2%处的筹码(%)
aa:=winner(c+c*n2/100)*100;
bb:=winner(c+c*n1/100)*100;
aa-bb

5)股价下方N1%至N2%处的筹码(%)
(winner(c-c*n1/100)-winner(c-c*n2/100))*100;

6)收盘价N%处的套牢盘 100-(winner(c*N/100))*100;
7)收盘价N%处的获利盘 winner(c*N/100)*100;
8)下影线 (MIN(O,C)-L)/L*100;
9)上影线 (h-**x(o,c))/**x(o,c)*100;
10)本周期的涨跌幅 (c-ref(c,1))/ref(c,1)*100;
11)振幅 (h-l)/l*100;
12)均线金叉(M.N为均线周期) cross(**(c,m),**(c,n))

13)均线多头排列
a1:=**(c,n1);
a2:=**(c,n2);
a3:=**(c,n3);
a4:=**(c,n4);
count(a1>a2 and a2>a3 and a3>a4,3);

14)均线空头排列
a1:=**(c,n1);
a2:=**(c,n2);
a3:=**(c,n3);
a4:=**(c,n4);
count(a1

15)N日均线向下
aa:=**(c,n);
bb:=ref(aa,2);
aa
16)向前N日至M日出现过均线死叉(P1
aa:=**(c,p1);
bb:=**(c,p2);
cc:=ref(cross(bb,aa),n);
count(cc,m);

17)今日成交量大于N日以来的均量 VOL>MA(VOL,N);

18)低位密集
A1:=COST(85);
A2:=COST(15);
A3:=A1-A2;
A4:=(A1+A2)/2;
A5:=A3/A4*100<10;
B1:=HHV(H,120);
B2:=LLV(L,120);
B3:=B1-B2;
B4:=(A4-B2)
A5 AND B4;

19)换手率 VOL/CAPITAL*100;

20)N日盈亏
V1:=VOL/SUM(VOL,N);
V2:=DMA(CLOSE,V1);
V3: (CLOSE-V2)/V2*100;

21)强势整理
{参数M、N分别代表周期和幅度 m:1 20 2 n:1 20 5}
a1:=abs(close-open)/open<0.015;
a2:=count(a1,m)=m;
a3:=ref(o,m)
ref(close,m)/ref(close,m+1)>1+n/100;
a2 and a3

22)高开大阴
{参数m,n分别代表幅度 m:1 10 4 n:1 20 5}
OPEN>CLOSE AND OPEN/REF(C,1) >= 1+M/100 AND CLOSE/OPEN<=1-N/100

23)低开大阳线
{参数m,n分别代表幅度 m:1 10 4 n:1 20 7}
OPEN<= 1-M/100 AND CLOSE/OPEN>=1+N/100

三、走势特征选股公式的编制

(1)、n日内创新高
　　 hhv(high,n)=hhv(high,0) and barscount(c)>=n;
注: n为指标参数，可在参数设定范围内设定参数范围。Hhv(x,n)，求n周期内x最高值，n=0则从第一个有效值开始；barscount(x),将当前位置到n周期前的数值设为1，若x非0，则将当前位置到n周期前的数值设为1。

(2)、n日内创新低
　　 llv(low,n)=llv(low,0) and barscount(close)>=n;
注n为指标参数，可在参数设定范围内设定参数范围。Llv(x,n)，求n周期内x最低值，n=0则从第一个有效值开始；barscount(x)第一个有效数据到当前的天数，例如，barscount(close)以于日线数据取得上市以来总交易日数。

(3)、n日内阴线多于阳线
　　 count(open>close,n)/n<0.5;
注: n为指标参数，可在参数设定范围内设定参数范围。同时可以自由编辑里面的数值(如0.5等　，达到确定阴线占全部K线个数的比例)。

(4)、n日内阳线多于阴线
　　　count(open0.5;
注: n为指标参数，可在参数设定范围内设定参数范围。同时可以自由编辑里面的数值(如0.5等　，达到确定阳线占全部K线个数的比例)。

(5)、n日内上涨多于下跌(第二天开盘高于前一天收盘)
count(c>ref(c,1),n)/n>0.5;
注: n为指标参数，可在参数设定范围内设定参数范围。同时可以自由编辑里面的数值(如0.5等　，达到确定其中比例)。

(6)、n日内上涨少于下跌(第二天开盘低于前一天收盘)
　　 count(c>ref(c,1),n)/n<0.5;
注: n为指标参数，可在参数设定范围内设定参数范围。同时可以自由编辑里面的数值(如0.5等，达到确定其中比例)。

(7)、连续n日收阳线
　 up:=close>open;
count(up,n)=n;
注: count(x,n),统计n周期中满足x条件的周期数，若n=0则从第一个有效值开始。n为指标参数，可在参数设定范围内设定参数范围。

(8)、连续n日内收阴线
　 up:=close
count(up,n)=n;
注: count(x,n),统计n周期中满足x条件的周期数，若n=0则从第一个有效值开始。N为指标参数，可在参数设定范围内设定参数范围。

(9)、连续n天上涨
　　　count(close>ref(close,1),n)=n;
注: count(x,n),统计n周期中满足x条件的周期数，若n=0则从第一个有效值开始。N为指标参数，可在参数设定范围内设定参数范围。

(10)、连续n天下跌
　　count(c
注: count(x,n),统计n周期中满足x条件的周期数，若n=0则从第一个有效值开始。N为指标参数，可在参数设定范围内设定参数范围。

(11)、首次创新高
　　　barssince(c>hhv(if(barscount(c)=1,high,0),0))+1=1;
注: barscount(x)，若x非0，则将当前位置到n周期前的数值设为1。

(12)、创历史新高
　　　hhv(close,0)=close;
注: hhv(x,n)，求n周期内x最高值，n=0则从第一个有效值开始。

(13)、创历史新低
　　　llv(close,0)=close;
注: llv(x,n)，求n周期内x最小值，n=0则从第一个有效值开始。

(14)、单日放量
　 a:=ref(**(vol,5),1);
vol/a>n and vol/capital*100>m;
注: n为指标参数，代表今日成交量和前一日的5日均量的比值，可在参数设定范围内设定参数范围。

(15)、阶段缩量
　　　sum(vol,n1)/capital<=n2;
注: n1为要统计的阶段时间，n2为缩量比例，可在参数设定范围内设定参数范围。

(16)、阶段放量
　　　sum(vol,n1)/capital>=n2;
注: n1为要统计的阶段时间，n2为y放量比例，可在参数设定范围内设定参数范围。

(17)、持续放量
　 a:=vol>ref(vol,1);
count(a,n)=n;
注: 其中条件a的含义为成交量较上一交易日放大，n为要统计的阶段时间，可在参数设定范围内设定参数范围。

(18)、持续缩量
　 a:=vol
count(a,n)=n;
注: 其中条件a的含义为成交量较上一交易日缩小，n为要统计的阶段时间，可在参数设定范围内设定参数范围。

(19)、间隔放量
　 a:=**(vol,5);
barscount(c)>=n and hhv(a,n)n2*a,n)>n3;
注: a.barscount(x)第一个有效数据到当前的天数。Barscount(c)对于日线数据取得上市以来总交易日数。
b.完整含义: n日内五日均量的最大值小于最小值的n1倍，成交量大于等于五日均量的n2倍的情况发生的次数多于n3次。

(20)、放量上攻
a:=(c-ref(c,1))/ref(c,1)>=(n/100);
sum(vol,n1)/capital>=(n2/100) and count(vol>ref(vol,1),n3 )=n3 and count(a,n3)=n3;
完整含义: 每日股价涨幅均大于n%，n1日内累计换手率大于n2%，并且成交量连续在n3日内放大。
 
(21)、温和放量上攻
股价小幅上扬
a1:=close/ref(close,1);
a2:=a1>1 and a1<1.03;
成交量小幅上扬
b1:=vol/ref(vol,1);
b2:=b1>1 and b1<2;
c1:=**(vol,n)/capital<0.05;
count(a2 and b2,n)/n>0.6 and c1;
完整公式为: 
a1:=close/ref(close,1);
a2:=a1>1 and a1<1.03;
b1:=vol/ref(vol,1);
b2:=b1>1 and b1<2;
c1:=**(vol,n)/capital<0.05;
count(a2 and b2,n)/n>0.6 and c1;
注: 公式分为股价小幅上扬和成交量小幅上扬两个部分，请在指标编写时注意其结构。

(22)、突然放量
　　　vol>ref(hhv(vol,n),1*m;
注: 当前成交量高于n个周期中最大成交量的m倍。

(23)、平台整理
　　　count(close,0)>n and (hhv(close,n)-llv(close,n))/llv(close,n)<=(n1/100);
注: count(close,0)>n为平台整理n个周期的设定。(hhv(close,n)-llv(close,n))/llv(close,n)<=(n1/100)为平台整理幅度n1%的设定。

(24)、突破长期盘整
ref(((hhv(h,n)-llv(l,n))/llv(l,n))/llv(l,n)),1)<=(n1/100) and c>=ref(hhv(h,n),1) and barscount(c)>n;
注: 前n日在上下n1%的幅度内整理: ref(((hhv(h,n)-llv(l,n))/llv(l,n))/llv(l,n)),1)<=(n1/100)；
今日突破: c>=ref(hhv(h,n),1)。

(25)、阶段强势股
　 a:=sum(if(date-n=0,indexc,0),0);
b:=sum(if(date-n1=0,indexc,0)0);
e:=sum(if(date-n=0,c,0),0);
f:=sum(if(date-n1=0,c,0),0);
((f-e)/e)>((b-a)/a);
注: 该公式求的是n日-n1日之间涨幅高于大盘的股票。n、n1参数的表达格式为yymmdd，注意在2000年前的表达为年份的后两位，例如1999年为99，从2000年开始以100依次向后累加，例如2001年9月14日为1010914，indexc函数表示同期大盘的收盘价，该函数对分笔成交分析周期无效。

(26)、阶段弱势股
　 a:=sum(if(date=n,indexc,0),0);
b:=sum(if(date=n1,indexc,0)0);
e:=sum(if(date=n,c,0),0);
f:=sum(if(date=n1,c,0),0);
((f-e)/e)<((b-a)/a);
注: 该公式求的是n日-n1日之间涨幅低于大盘的股票。n、n1参数的表达格式为yymmdd，注意在2000年前的表达为年份的后两位，例如1999年为99，从2000年开始以100依次向后累加，例如2001年9月14日为1010914，indexc函数表示同期大盘的收盘价，该函数对分笔成交分析周期无效。

(27)、大盘同步
　　　count((c>o and indexc>indexo) or (cm/100;
注: 含义为n周期中与大盘走势相同(同收阴线或同收阳线)的例超过m%。此处的o不是数字的零，而是开盘价open的首写字母o。

(28)、n日内强势股
a:=(c-ref(o,n))/ref(o,n);
b:=(indexc-ref(indexo,n))/ref(indexo,n);
a>b and a/b>=m;
注: n日内个股涨幅大于等于大盘涨幅的m倍。

四、形态特征选股公式的编制

(1)、均线多头排列
　 a1:=**(c,n1);
a2:=**(c,n2);
a3:=**(c,n3);
a4:=**(c,n4);
count(a1>a2 and a2>a3 and a3>a4,3)=3 and isup;
注: n1、n2、n3、n4j日均线呈多头排列，isup也可以用close>open表示。

(2)、均线空头排列
　 a1:=**(c,n1);
a2:=**(c,n2);
a3:=**(c,n3);
a4:=**(c,n4);
count(a1
注: n1、n2、n3、n4j日均线呈空头排列，isup也可以用close

(3)、早晨之星
　　　ref(close,2)/ref(open,2<0.95 and ref(open,1)<0.03 andclose/open>1.05 and close>ref(close,2);
注: 早晨之星，这种形态和叫法自然是后市向好，为买进信号。早晨之星由三根K线组成，其顺序是: 第一天在下跌过程中已形成一根阴线: 
　　　ref(close,2)/ref(open,2<0.95
第二天呈裂口下跌，K线实体较短，构成星的主体部分，阴线或阳线均可，有无上下影线均不重要。
　　　ref(open,1)<0.03
　　　关键是第三根K线必须是阳线，且其长度至少要升至第一根阴线实体(如果能够“包容”第一根阴线则最好不过了)
　　　close/open>1.05 and close>ref(close,2)

(4)、强势整理
a1:=abs(close-open)/open<0.015;
a2:=count(a,m)=m;
a3:=ref(o,m)1+n/100;
a2 and a3;
注: 一根实体超过n的长阳，后面跟m个K线实体不超过1.5％的K线。

(5)、高开大阴线
　　　open>close and open/ref(c,1)>=1+m/100 and close/open<=1-n/100;
注: 跳空高开m%，当日股价较开盘价跌幅大于n。股价经过一段持续攀升之后，某一日突然跳高开盘: 
　　　open/ref(c,1)>=1+m/100
　　　后股价一路下行，尾市以接近最低点收市: 
　　　close/open<=1-n/100
　　　此信号出现，往往意味着股价已形成短期头部，应注意回避风险。

(6)、低开大阳线
　　　open<=1-m/100 and close/open>=1+n/100;
注: 跳空低开m%，当日股价较开盘价涨幅大于n，其他描述请参见(5)。

(7)、黄昏之星
　　　ref(close,2)/ref(open,2)>1.03 and ref(open,1)>ref(close,2) andabs(ref(open,1)-ref(close,1)/ref(close,1)<0.02 andclose/open<0.97 and close
注: 黄昏之星表示股价回落，是卖出信号，应伺机抛货。幕星同样由三根K线组成，其形态晨星正好相反: 
　　　第一天股价继续上升，拉出一根阳线: 
　　　ref(close,2)/ref(open,2)>1.03
　　　第二天波动较小，形成一根小阳线或小阴线，构成星的主体部分: 
　　　ref(open,1)>ref(close,2) and abs(ref(open,1)-ref(close,1)/ref(close,1)<0.02
　　　第三天形成一根包容第二天并延伸至第一天阳线实体: 
　　　close/open<0.97 and close

(8)、跳空缺口
　　　highref(high,1);
注: 从内容上看，分别是向下跳空缺口和向上跳空缺口。

(9)、均线金叉
　 a;=**(c,5);
b:=**(c,10);
cross(a,b);
注: 前二句是5、10日均线，cross是交叉函数，cross(a,b)表示5日均线与10日均线金叉。

(10)、均线死叉
　 a;=**(c,5);
b:=**(c,10);
cross(b,a);
注: 前二句是5、10日均线，cross是交叉函数，cross(b,a)表示5日均线与10日均线死叉。

(11)、均线粘合
**1:=**(c,5);
**2:=**(c,10),
**3:=**(c,20);
　 p1:=abs(**1-**2)+abs(**2-**3);
p1/cref(**1,1) and **2>ref(**2,1);
注: 前三句是三根均线，p1是第一根均线减第二根均线差的绝对值与第二根均线减第三根均线差的绝对值之和，最后一句是p1与收盘价的比值小于一定比率m%(一般该比率为2％以下，同时前二均线今日比昨日上翘。

指标公式编辑必备(三)


1.成交量连续5天超过30天均量点
count(vol>**(vol,30),5)=5

2.编一选股公式；要求1；日均线多头排列的情况下(5，10，30，60。。。)2: 5日。10日均线高度粘合--相等或相差1-2分钱，30均线与5，10均线相差1角以下。3: 日量比大于2。先谢谢！！！

1.**(c,5)>**(c,10) and **(c,10)>**(c,30) and **(c,30)>**(c,60) and 。。。

2.abs(**(c,5)-**(c,10))<0.03 and abs(**(c,30)-**x(**(c,5),**(c,10)))<0.1

3.DYNAINFO(17)>2

3.威力雷达rad7日内连续上扬怎样编写？谢谢
V1:=(c/ref(c,1)-indexc/ref(indexc,1))*200;
RAD:=sum(v1,0);

count(rad>ref(rad,1),7)=7

威力雷达Mrad在7日内连续上扬怎样编写？谢谢
V1:=(c/ref(c,1)-indexc/ref(indexc,1))*200;
RAD:=sum(v1,0);
MRAD:=MA(RAD,30);
count(mrad>ref(mrad,1),7)=7

4.请问。10日内涨幅大于10%的选股公式怎样编？
c/ref(c,10)>1.1

5.如何编写股价在一个上涨或下跌的行情中第3次触及30日均线时发出提醒的指标？
M3:=MA(C,30);
N1:=BARSLAST(M3>REF(M3,1));
AA:=CROSS(C,M3);
COUNT(AA,N1)=3


6.请问:cys指标中数值要小于-5，怎样编写到其他指标中.，谢谢！
(C-CYC(13))/CYC(13)*100<-5

7.当涨幅大于5％，要主图K线的实体的一半变为另一色。如何表达？
STICKLINE(c/ref(c,1)>1.05,(c+o)/2,c,10,1),coloryellow;

8.成交量连续3天涨的公式
COUNT(VOL>REF(VOL,1),3)=3

9.请问怎样用公式表示年线摆脱下降趋势出现向上拐头？
COUNT(MA(C,250)>REF(MA(C,250),1),3)=3

10.股价创出新高后，又调整到30日均线附近的选股公式如何编写？
COUNT(C>=HHV(C,N),5)=1 AND C/MA(C,30)>=1 AND C/MA(C,30)<1.02


11.怎么定义一阳线紧跟两阴线的函数?
ref(c,2)>ref(o,2) and ref(c,1)

12.60日线在过去的10天内涨跌幅度在 1%
COUNT(BETWEEN(**(c,60),ref(**(c,60),10)*1.01,ref(**(c,60),10)*0.99),10)=10;

13.RSI(周线)在70天内第二次上穿80，如何编制？
COUNT(CROSS("RSI.RSI1#WEEK",80),70)=2

14.今天涨幅3%昨天涨幅2%前天涨幅1%的个股
(c-ref(c,1))/ref(c,1)>0.3 and (ref(c,1)-ref(c,2))/ref(c,2)>0.2 and (ref(c,2)-ref(c,3))/ref(c,3)>0.1

15.破5天线，3天后又重新站上5天线的个股
cross(ref(**(c,5),3),ref(c,3)) and cross(c,**(c,5))

16.今天一阳上穿5，10，30天线个股
cross(c,**(c,5) and cross(c,**(c,10)) and cross(c,**(c,30))

17.3天内5天线上穿10天线，10天线上穿20天线的个股
count(cross(**(c,5),**(c,10)),3)>=1 and count(cross(**(c,10),**(c,20)),3)>=1
```